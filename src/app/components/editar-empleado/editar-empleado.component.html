<div class="container">
    <h2 class="mb-4">Editar Empleado</h2>
  
    <div *ngIf="error" class="alert alert-danger">
      {{ error }}
    </div>
  
    <div *ngIf="cargandoDatos" class="text-center my-5">
      <div class="spinner-border" role="status">
        <span class="visually-hidden">Cargando...</span>
      </div>
      <p class="mt-2">Cargando información del empleado...</p>
    </div>
  
    <form *ngIf="!cargandoDatos" [formGroup]="empleadoForm" (ngSubmit)="onSubmit()">
      <div class="row">
        <!-- Datos personales -->
        <div class="col-md-6">
          <div class="card mb-4">
            <div class="card-header">
              Datos Personales
            </div>
            <div class="card-body">
              <div class="mb-3">
                <label for="nombre" class="form-label">Nombre(s) *</label>
                <input type="text" class="form-control" id="nombre" formControlName="nombre">
                <div *ngIf="nombreNoValido" class="text-danger">
                  El nombre es requerido y debe tener al menos 2 caracteres
                </div>
              </div>
  
              <div class="mb-3">
                <label for="apellidoPaterno" class="form-label">Apellido Paterno *</label>
                <input type="text" class="form-control" id="apellidoPaterno" formControlName="apellidoPaterno">
                <div *ngIf="apellidoPaternoNoValido" class="text-danger">
                  El apellido paterno es requerido y debe tener al menos 2 caracteres
                </div>
              </div>
  
              <div class="mb-3">
                <label for="apellidoMaterno" class="form-label">Apellido Materno</label>
                <input type="text" class="form-control" id="apellidoMaterno" formControlName="apellidoMaterno">
              </div>
  
              <div class="mb-3">
                <label for="fechaNacimiento" class="form-label">Fecha de Nacimiento *</label>
                <input type="date" class="form-control" id="fechaNacimiento" formControlName="fechaNacimiento">
              </div>
  
              <!-- Foto del empleado -->
              <div class="mb-3">
                <label for="foto" class="form-label">Foto</label>
                <div class="d-flex flex-column">
                  <!-- Previsualización de la foto -->
                  <div *ngIf="fotoPreview" class="mb-2 text-center">
                    <img [src]="fotoPreview" alt="Vista previa" class="img-thumbnail" style="max-width: 150px; max-height: 150px;">
                  </div>
                  <!-- Input para seleccionar archivo -->
                  <input 
                    type="file" 
                    class="form-control" 
                    id="foto" 
                    accept="image/*"
                    (change)="onFileSelected($event)">
                  <small class="form-text text-muted">Seleccione una imagen(JPG, PNG, GIF)</small>
                </div>
              </div>
            </div>
          </div>
        </div>
  
        <!-- Datos de contacto -->
        <div class="col-md-6">
          <div class="card mb-4">
            <div class="card-header">
              Datos de Contacto
            </div>
            <div class="card-body">
              <div class="mb-3">
                <label for="direccion" class="form-label">Dirección *</label>
                <input type="text" class="form-control" id="direccion" formControlName="direccion">
              </div>
  
              <div class="mb-3">
                <label for="ciudad" class="form-label">Ciudad *</label>
                <select class="form-select" id="ciudad" formControlName="ciudad">
                  <option value="">Seleccionar ciudad</option>
                  <option *ngFor="let ciudad of ciudades" [value]="ciudad">{{ ciudad }}</option>
                </select>
              </div>
  
              <div class="mb-3">
                <label for="telefono" class="form-label">Teléfono *</label>
                <input type="tel" class="form-control" id="telefono" formControlName="telefono">
              </div>
  
              <div class="mb-3">
                <label for="email" class="form-label">Email *</label>
                <input type="email" class="form-control" id="email" formControlName="email">
              </div>
            </div>
          </div>
        </div>
  
        <!-- Datos laborales -->
        <div class="col-12">
          <div class="card mb-4">
            <div class="card-header">
              Datos Laborales
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-4">
                  <div class="mb-3">
                    <label for="fechaIngreso" class="form-label">Fecha de Ingreso *</label>
                    <input type="date" class="form-control" id="fechaIngreso" formControlName="fechaIngreso">
                  </div>
                </div>
  
                <div class="col-md-4">
                  <div class="mb-3">
                    <label for="puesto" class="form-label">Puesto *</label>
                    <select class="form-select" id="puesto" formControlName="puesto">
                      <option value="">Seleccionar puesto</option>
                      <option *ngFor="let puesto of puestos" [value]="puesto">{{ puesto }}</option>
                    </select>
                  </div>
                </div>
  
                <div class="col-md-4">
                  <div class="mb-3">
                    <label for="departamento" class="form-label">Departamento *</label>
                    <select class="form-select" id="departamento" formControlName="departamento">
                      <option value="">Seleccionar departamento</option>
                      <option *ngFor="let departamento of departamentos" [value]="departamento">{{ departamento }}</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
  
      <div class="d-flex justify-content-between mt-4">
        <button type="button" class="btn btn-secondary" routerLink="/empleados">Cancelar</button>
        <button type="submit" class="btn btn-primary" [disabled]="empleadoForm.invalid || cargando">
          <span *ngIf="cargando" class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
          Guardar Cambios
        </button>
      </div>
    </form>
  </div>